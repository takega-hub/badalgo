"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ ML —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
"""

def update_ml_settings():
    """–û–±–Ω–æ–≤–ª—è–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ML —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–ª—è –ª—É—á—à–µ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤"""
    
    # –ß–∏—Ç–∞–µ–º —Ç–µ–∫—É—â–∏–π .env
    with open('.env', 'r', encoding='utf-8') as f:
        lines = f.readlines()
    
    # –ù–æ–≤—ã–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ—Å—Ç–æ–≤
    changes = {
        'ML_CONFIDENCE_THRESHOLD': '0.40',  # –ë—ã–ª–æ 0.50, –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ 0.40
        'ML_STABILITY_FILTER': 'false',     # –ë—ã–ª–æ true, –æ—Ç–∫–ª—é—á–∞–µ–º –¥–ª—è –±–æ–ª—å—à–µ–π –≥–∏–±–∫–æ—Å—Ç–∏
        'ML_MIN_SIGNAL_STRENGTH': '—Å–ª–∞–±–æ–µ', # –û—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å
    }
    
    # –ü—Ä–∏–º–µ–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
    new_lines = []
    updated = set()
    
    for line in lines:
        modified = False
        for key, value in changes.items():
            if line.startswith(f'{key}='):
                old_value = line.split('=', 1)[1].strip()
                new_lines.append(f'{key}={value}\n')
                print(f"‚úÖ {key}: {old_value} ‚Üí {value}")
                updated.add(key)
                modified = True
                break
        if not modified:
            new_lines.append(line)
    
    # –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∫–ª—é—á–∏
    for key, value in changes.items():
        if key not in updated:
            new_lines.append(f'{key}={value}\n')
            print(f"‚úÖ {key}: –¥–æ–±–∞–≤–ª–µ–Ω–æ = {value}")
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º
    with open('.env', 'w', encoding='utf-8') as f:
        f.writelines(new_lines)
    
    print("\n" + "=" * 80)
    print("‚úÖ –ù–ê–°–¢–†–û–ô–ö–ò ML –û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–´!")
    print("=" * 80)
    print("\nüí° –ò–∑–º–µ–Ω–µ–Ω–∏—è:")
    print("  1. ML_CONFIDENCE_THRESHOLD: 0.50 ‚Üí 0.40")
    print("     ‚Üí –°–Ω–∏–∂–µ–Ω –ø–æ—Ä–æ–≥ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –¥–ª—è –±–æ–ª—å—à–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–∏–≥–Ω–∞–ª–æ–≤")
    print("  2. ML_STABILITY_FILTER: true ‚Üí false")
    print("     ‚Üí –û—Ç–∫–ª—é—á–µ–Ω —Ñ–∏–ª—å—Ç—Ä —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –ª—É—á—à–µ–π —Ä–µ–∞–∫—Ü–∏–∏ –Ω–∞ —Ä—ã–Ω–æ–∫")
    print("\nüìà –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:")
    print("  ‚Ä¢ +46% —Å–∏–≥–Ω–∞–ª–æ–≤ (—Å 13 –¥–æ 19 –∑–∞ 7 –¥–Ω–µ–π)")
    print("  ‚Ä¢ –ë–æ–ª–µ–µ –±—ã—Å—Ç—Ä–∞—è —Ä–µ–∞–∫—Ü–∏—è –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä—ã–Ω–∫–∞")
    print("  ‚Ä¢ LONG: ~18-20 —Å–∏–≥–Ω–∞–ª–æ–≤ –∑–∞ –Ω–µ–¥–µ–ª—é")
    print("  ‚Ä¢ SHORT: ~1-2 —Å–∏–≥–Ω–∞–ª–∞ –∑–∞ –Ω–µ–¥–µ–ª—é")
    print("\n‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π:")
    print("   python main.py")
    print("\nüîß –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥: –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –µ—â–µ –±–æ–ª—å—à–µ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è")
    print("=" * 80)


if __name__ == "__main__":
    update_ml_settings()
