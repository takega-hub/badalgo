# Тестирование ML стратегии

Скрипт `test_ml_strategy.py` позволяет проверить, сколько и какие сигналы генерирует ML стратегия на исторических данных.

## Использование

### Базовый запуск (с настройками по умолчанию)
```bash
python test_ml_strategy.py --symbol BTCUSDT --days 7
```

### С пониженными порогами (для диагностики)
```bash
python test_ml_strategy.py --symbol BTCUSDT --days 7 --confidence 0.5 --strength слабое --no-stability
```

### Параметры

- `--symbol` - Торговая пара (BTCUSDT, ETHUSDT, SOLUSDT). По умолчанию: BTCUSDT
- `--days` - Количество дней назад для тестирования. По умолчанию: 7
- `--model` - Путь к модели (по умолчанию: авто-поиск)
- `--confidence` - Порог уверенности (0.0-1.0). По умолчанию: из настроек
- `--strength` - Минимальная сила сигнала ("слабое", "умеренное", "среднее", "сильное", "очень_сильное"). По умолчанию: из настроек
- `--no-stability` - Отключить фильтр стабильности

## Что показывает скрипт

1. **Общая статистика сигналов:**
   - Количество LONG, SHORT, HOLD сигналов
   - Процентное распределение

2. **Статистика уверенности:**
   - Минимум, максимум, среднее, медиана уверенности модели
   - Сколько предсказаний прошло бы пороги

3. **Анализ причин фильтрации:**
   - Почему сигналы не генерируются
   - Какие фильтры блокируют сигналы

4. **Примеры сигналов:**
   - Первые 10 сигналов
   - Последние 10 сигналов
   - Причины генерации каждого сигнала

## Диагностика отсутствия сигналов

Если стратегия не генерирует сигналы, скрипт автоматически запускает диагностику:

- Анализирует последние 50 баров
- Показывает статистику предсказаний модели
- Показывает причины фильтрации сигналов
- Дает рекомендации по настройке параметров

## Примеры использования

### Тест для BTCUSDT за последние 3 дня с мягкими параметрами
```bash
python test_ml_strategy.py --symbol BTCUSDT --days 3 --confidence 0.5 --strength слабое
```

### Тест для ETHUSDT за последнюю неделю с текущими настройками
```bash
python test_ml_strategy.py --symbol ETHUSDT --days 7
```

### Тест с отключенным фильтром стабильности
```bash
python test_ml_strategy.py --symbol SOLUSDT --days 5 --no-stability
```

## Интерпретация результатов

- **Если сигналов нет:** Попробуйте снизить пороги (`--confidence 0.5 --strength слабое`)
- **Если сигналов слишком много:** Повысьте пороги (`--confidence 0.8 --strength сильное`)
- **Если все сигналы HOLD:** Модель слишком консервативна, возможно нужна переобучка
